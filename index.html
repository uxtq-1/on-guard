<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OPS Mobile FAB Nav</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css">

  <style>
    @media screen and (max-width: 768px) {
      body {
        margin: 0;
        font-family: Arial, sans-serif;
      }

      .fab-toggle {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background-color: #007bff;
        color: #fff;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.5rem;
        z-index: 4000;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        border: none;
      }

      .mobile-nav {
        position: fixed;
        bottom: 20px;
        right: 90px; /* Positioned to the left of the FAB */
        display: flex;
        flex-direction: row-reverse; /* Icons layout right to left, so expansion feels leftward */
        gap: 10px;
        background: #fff;
        padding: 0.5rem 1rem;
        border-radius: 30px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        z-index: 3000;
        /* Horizontal expansion: starts off-screen (or zero width) and slides/grows into view */
        transform: translateX(calc(100% + 10px)); /* Start off-screen to the right, plus gap */
        /* Alternatively, for a scaling effect from the right:
        transform: scaleX(0);
        transform-origin: right center;
        */
        visibility: hidden;
        opacity: 0;
        transition: transform 0.3s ease, opacity 0.3s ease, visibility 0s 0.3s;
      }

      .mobile-nav.active {
        transform: translateX(0);
        /* Alternatively, for scaling:
        transform: scaleX(1);
        */
        opacity: 1;
        visibility: visible;
        transition: transform 0.3s ease, opacity 0.3s ease, visibility 0s 0s;
      }

      .mobile-nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        color: #333;
        background: none;
        border: none;
        font-size: 0.75rem;
        cursor: pointer;
      }

      .mobile-nav-item i {
        font-size: 1.4rem;
      }

      .mobile-services-menu {
        position: fixed;
        bottom: 90px; /* Adjusted to be above the nav bar items */
        right: 20px; /* Align with the FAB */
        background: #fff;
        border: 1px solid #ccc;
        padding: 1rem;
        display: none; /* Controlled by JS */
        z-index: 2000;
        border-radius: 10px;
        max-height: calc(100vh - 120px); /* Max height considering FAB and some padding */
        overflow-y: auto;
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      }

      .mobile-services-menu.active {
        display: block;
      }

      .mobile-services-menu ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .mobile-services-menu li {
        margin-bottom: 10px;
      }

      .mobile-services-menu a {
        text-decoration: none;
        color: #333;
        font-size: 1rem;
      }

      body.dark .fab-toggle {
        background-color: #1a1a1a; /* Darker FAB background */
        color: #007bff; /* Keep icon color prominent or adjust as needed */
      }

      body.dark .mobile-nav,
      body.dark .mobile-services-menu {
        background: #222; /* Dark background for nav and services menu */
        color: #eee; /* Light text for dark background */
        border-color: #444; /* Darker border */
      }

      body.dark .mobile-nav-item,
      body.dark .mobile-services-menu a {
        color: #eee; /* Light text for items and links */
      }
    }

    @media screen and (min-width: 769px) {
      .fab-toggle,
      .mobile-nav,
      .mobile-services-menu {
        display: none;
      }
    }
  </style>
</head>

<body>

  <!-- Floating Action Button (FAB) -->
  <button class="fab-toggle" id="fabToggle" aria-label="Toggle Menu" aria-expanded="false">
    <i class="fas fa-bars"></i> <!-- Default Icon -->
  </button>

  <!-- Expanding Nav Bar -->
  <nav class="mobile-nav" id="mobileNav">
    <a href="index.html" class="mobile-nav-item" data-en-text="Home" data-es-text="Inicio">
      <i class="fas fa-home"></i>
      <span data-en="Home" data-es="Inicio">Home</span>
    </a>

    <button class="mobile-nav-item" id="mobile-services-toggle" aria-expanded="false" aria-controls="mobile-services-menu" data-en-text="Services" data-es-text="Servicios">
      <i class="fas fa-cogs"></i>
      <span data-en="Services" data-es="Servicios">Services</span>
    </button>

    <button class="mobile-nav-item lang-toggle-btn" id="mobile-language-toggle" aria-label="Switch Language" title="Switch Language" data-en-label="Switch to Spanish" data-es-label="Cambiar a InglÃ©s">EN</button>

    <button class="mobile-nav-item theme-toggle-btn" id="mobile-theme-toggle" aria-label="Toggle Theme" title="Toggle Theme" data-en-label-dark="Switch to Dark Theme" data-es-label-dark="Cambiar a Tema Oscuro" data-en-label-light="Switch to Light Theme" data-es-label-light="Cambiar a Tema Claro">Light</button>

    <button class="mobile-nav-item" id="mobileChatLauncher" data-modal="chatbot-modal" aria-label="Open Chat" title="Open Chat" data-en-text="Chat" data-es-text="Chat">
      <i class="fas fa-comment-alt"></i>
      <span data-en="Chat" data-es="Chat">Chat</span>
    </button>
  </nav>

  <!-- Services Menu -->
  <div class="mobile-services-menu" id="mobile-services-menu" role="menu" aria-hidden="true">
    <ul>
      <li><a role="menuitem" href="html/business-operations.html" data-en="Business Operations" data-es="Operaciones Empresariales">Business Operations</a></li>
      <li><a role="menuitem" href="html/contact-center.html" data-en="Contact Center" data-es="Centro de Contacto">Contact Center</a></li>
      <li><a role="menuitem" href="html/it-support.html" data-en="IT Support" data-es="Soporte IT">IT Support</a></li>
      <li><a role="menuitem" href="html/professionals.html" data-en="Professionals" data-es="Profesionales">Professionals</a></li>
    </ul>
  </div>

  <!-- JS -->
  <script>
    const fabToggle = document.getElementById('fabToggle');
    const mobileNav = document.getElementById('mobileNav');
    const servicesToggle = document.getElementById('mobile-services-toggle');
    const servicesMenu = document.getElementById('mobile-services-menu');
    const fabIcon = fabToggle.querySelector('i'); // Get the icon element

    fabToggle.addEventListener('click', () => {
      const isNavActive = mobileNav.classList.toggle('active');
      fabToggle.setAttribute('aria-expanded', isNavActive);

      // Toggle FAB icon
      if (isNavActive) {
        fabIcon.classList.remove('fa-bars');
        fabIcon.classList.add('fa-times'); // Change to 'close' icon
      } else {
        fabIcon.classList.remove('fa-times');
        fabIcon.classList.add('fa-bars'); // Change back to 'menu' icon
        // If services menu is open, close it when main nav closes
        if (servicesMenu.classList.contains('active')) {
          servicesMenu.classList.remove('active');
          servicesToggle.setAttribute('aria-expanded', 'false');
          servicesMenu.setAttribute('aria-hidden', 'true');
        }
      }
    });

    servicesToggle.addEventListener('click', (event) => {
      event.stopPropagation(); // Prevent click from closing the nav if it's already open
      const isServicesActive = servicesMenu.classList.toggle('active');
      servicesToggle.setAttribute('aria-expanded', isServicesActive);
      servicesMenu.setAttribute('aria-hidden', !isServicesActive);
    });

    const langToggle = document.getElementById('mobile-language-toggle');
    langToggle.addEventListener('click', () => {
      const isEnglish = langToggle.textContent === 'EN';
      document.querySelectorAll('[data-en]').forEach(el => el.textContent = isEnglish ? el.getAttribute('data-es') : el.getAttribute('data-en'));
      document.querySelectorAll('[data-en-text]').forEach(el => el.setAttribute('title', isEnglish ? el.getAttribute('data-es-text') : el.getAttribute('data-en-text')));
      document.querySelectorAll('[data-en-label]').forEach(el => el.setAttribute('aria-label', isEnglish ? el.getAttribute('data-es-label') : el.getAttribute('data-en-label')));
      langToggle.textContent = isEnglish ? 'ES' : 'EN';
    });

    const themeToggle = document.getElementById('mobile-theme-toggle');
    themeToggle.addEventListener('click', () => {
      const isCurrentlyLight = themeToggle.textContent === 'Light';
      document.body.classList.toggle('dark', isCurrentlyLight);
      themeToggle.textContent = isCurrentlyLight ? 'Dark' : 'Light';

      // Update ARIA labels for theme toggle based on the new state
      if (document.body.classList.contains('dark')) {
        themeToggle.setAttribute('aria-label', themeToggle.dataset.enLabelLight); // Assuming it's now dark, so button shows "Light"
        themeToggle.setAttribute('title', themeToggle.dataset.enLabelLight);
      } else {
        themeToggle.setAttribute('aria-label', themeToggle.dataset.enLabelDark); // Assuming it's now light, so button shows "Dark"
        themeToggle.setAttribute('title', themeToggle.dataset.enLabelDark);
      }
    });

    const chatBtn = document.getElementById('mobileChatLauncher');
    chatBtn.addEventListener('click', () => {
      alert('Chatbot modal launch goes here.'); // Placeholder
    });

    // Close mobile nav and services menu if clicking outside
    document.addEventListener('click', function(event) {
      const isClickInsideNav = mobileNav.contains(event.target);
      const isClickInsideFab = fabToggle.contains(event.target);
      const isClickInsideServicesMenu = servicesMenu.contains(event.target);
      const isClickOnServicesToggle = servicesToggle.contains(event.target);

      // If nav is active and click is outside nav and FAB
      if (mobileNav.classList.contains('active') && !isClickInsideNav && !isClickInsideFab && !isClickOnServicesToggle) {
        mobileNav.classList.remove('active');
        fabIcon.classList.remove('fa-times');
        fabIcon.classList.add('fa-bars');
        fabToggle.setAttribute('aria-expanded', 'false');
        // Also close services menu if it's open
        if (servicesMenu.classList.contains('active')) {
          servicesMenu.classList.remove('active');
          servicesToggle.setAttribute('aria-expanded', 'false');
          servicesMenu.setAttribute('aria-hidden', 'true');
        }
      }
      // If services menu is active and click is outside services menu and its toggle, but not inside main nav
      else if (servicesMenu.classList.contains('active') && !isClickInsideServicesMenu && !isClickOnServicesToggle && !isClickInsideNav) {
         servicesMenu.classList.remove('active');
         servicesToggle.setAttribute('aria-expanded', 'false');
         servicesMenu.setAttribute('aria-hidden', 'true');
      }
    });

  </script>

</body>
</html>
