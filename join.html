<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Join Us - OPS Online Solutions</title>

  <!-- SEO & Social -->
  <meta name="description" content="Join OPS Online Solutions and be part of a secure, innovative team driving next-gen IT and business services." />
  <meta property="og:title" content="Join OPS Online Solutions" />
  <meta property="og:description" content="Apply securely to OPS Solutions. Upload your resume and join the mission." />
  <meta property="og:url" content="https://www.opsonlinesolutions.com/join.html" />

  <!-- CSP -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'nonce-abc123' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net 'unsafe-inline';
    style-src 'self' 'nonce-abc123';
    img-src 'self' https://trusted-cdn.com;
    connect-src 'self' https://YOUR_CLOUDFLARE_WORKER_ENDPOINT;
    frame-ancestors 'none';
    object-src 'none';
    base-uri 'self';
    form-action 'self';
  " />

  <style nonce="abc123">
    /* Clean modern base */
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background: #f5f8fa;
      color: #222;
      padding: 2rem 1rem;
    }
    main {
      max-width: 720px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      padding: 2rem 3rem 3rem;
      transition: box-shadow 0.3s ease;
    }
    main:hover {
      box-shadow: 0 10px 30px rgba(0,0,0,0.16);
    }
    h1 {
      text-align: center;
      margin-bottom: 0.6rem;
      font-weight: 700;
      color: #007ACC;
      letter-spacing: 0.03em;
    }
    p.description {
      text-align: center;
      font-size: 1.05rem;
      margin-bottom: 2rem;
      color: #555;
    }
    label {
      display: block;
      font-weight: 600;
      margin: 1rem 0 0.5rem;
      color: #333;
    }
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    textarea {
      width: 100%;
      padding: 0.65rem 1rem;
      font-size: 1rem;
      border-radius: 6px;
      border: 1.5px solid #ccc;
      transition: border-color 0.3s ease;
      font-weight: 400;
      outline-offset: 2px;
    }
    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="tel"]:focus,
    textarea:focus {
      border-color: #007ACC;
      box-shadow: 0 0 6px rgba(0,122,204,0.3);
    }
    textarea {
      resize: vertical;
      min-height: 100px;
      font-family: inherit;
    }
    button, .expandable-section button {
      margin-top: 1rem;
      font-weight: 600;
      font-size: 1rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.25s ease;
      display: inline-block;
      padding: 0.6rem 1.4rem;
      background-color: #007ACC;
      color: white;
      user-select: none;
      letter-spacing: 0.02em;
    }
    button:hover, .expandable-section button:hover {
      background-color: #005fa3;
    }
    .expandable-section {
      margin-bottom: 2rem;
      border-left: 3px solid #007ACC;
      padding-left: 1rem;
      background: #f0f7ff;
      border-radius: 6px;
    }
    .expandable-section button {
      background: transparent;
      color: #007ACC;
      text-decoration: underline;
      font-weight: 600;
      margin-top: 0.4rem;
      padding: 0;
      font-size: 0.95rem;
      border-radius: 0;
    }
    .field-group input {
      margin-top: 0.4rem;
      font-weight: 400;
    }
    /* Popup style */
    #popup {
      position: fixed;
      top: 12%;
      left: 50%;
      transform: translateX(-50%);
      max-width: 650px;
      background: white;
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
      padding: 1.5rem 2rem;
      border-radius: 10px;
      z-index: 11000;
      font-size: 1rem;
      color: #333;
      font-weight: 500;
      line-height: 1.5;
      user-select: text;
    }
    #popup ul {
      padding-left: 1.2rem;
      margin-top: 0.8rem;
      margin-bottom: 1rem;
    }
    #popup a {
      color: #007ACC;
      font-weight: 600;
      text-decoration: none;
      transition: color 0.3s ease;
    }
    #popup a:hover, #popup a:focus {
      color: #005fa3;
      outline: none;
    }
    #popup button {
      display: block;
      margin-left: auto;
      margin-top: 1rem;
      background-color: #007ACC;
      color: white;
      padding: 0.6rem 1.3rem;
      font-weight: 600;
      font-size: 1rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      transition: background-color 0.25s ease;
      user-select: none;
    }
    #popup button:hover {
      background-color: #005fa3;
    }
    /* Language toggle */
    .lang-toggle {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 1.8rem;
    }
    .lang-toggle label {
      margin-right: 0.5rem;
      font-weight: 600;
      color: #444;
      user-select: none;
      align-self: center;
    }
    .lang-toggle select {
      padding: 0.3rem 0.5rem;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-weight: 600;
      outline-offset: 2px;
    }
  </style>
</head>

<body>
  <main role="main" aria-labelledby="pageTitle">
    <div class="lang-toggle" aria-label="Language selector">
      <label for="language-select">Language / Idioma:</label>
      <select id="language-select" aria-describedby="language-select-desc">
        <option value="en" selected>English</option>
        <option value="es">Español</option>
      </select>
    </div>

    <h1 id="pageTitle">Join Us at OPS Online Solutions</h1>
    <p id="description" class="description">Please copy-paste your information into the fields below to apply securely.</p>

    <form id="join-form" autocomplete="off" novalidate>
      <label for="firstName" id="label-firstName">First Name *</label>
      <input type="text" id="firstName" name="firstName" required placeholder="Your first name" autocomplete="given-name" />

      <label for="lastName" id="label-lastName">Last Name *</label>
      <input type="text" id="lastName" name="lastName" required placeholder="Your last name" autocomplete="family-name" />

      <label for="address" id="label-address">Address</label>
      <input type="text" id="address" name="address" placeholder="Your address" autocomplete="street-address" />
      
      <label for="zipCode" id="label-zipCode">Zip Code</label>
      <input type="text" id="zipCode" name="zipCode" placeholder="Zip or postal code" autocomplete="postal-code" />

      <label for="contactNumber" id="label-contactNumber">Contact Number *</label>
      <input type="tel" id="contactNumber" name="contactNumber" required placeholder="+1 234 567 8901" autocomplete="tel" />

      <label for="email" id="label-email">Email *</label>
      <input type="email" id="email" name="email" required placeholder="your@email.com" autocomplete="email" />

      <!-- Expandable sections -->
      <section class="expandable-section" id="experience-section" aria-label="Experience">
        <label id="label-experience">Experience</label>
        <div class="field-group" id="experience-group">
          <input type="text" name="experience[]" placeholder="Experience detail" />
        </div>
        <button type="button" id="add-experience" aria-controls="experience-group" aria-expanded="false" class="expand-btn">+ Add Experience</button>
      </section>

      <section class="expandable-section" id="certification-section" aria-label="Certification">
        <label id="label-certification">Certification</label>
        <div class="field-group" id="certification-group">
          <input type="text" name="certification[]" placeholder="Certification detail" />
        </div>
        <button type="button" id="add-certification" aria-controls="certification-group" aria-expanded="false" class="expand-btn">+ Add Certification</button>
      </section>

      <section class="expandable-section" id="education-section" aria-label="Education">
        <label id="label-education">Education</label>
        <div class="field-group" id="education-group">
          <input type="text" name="education[]" placeholder="Education detail" />
        </div>
        <button type="button" id="add-education" aria-controls="education-group" aria-expanded="false" class="expand-btn">+ Add Education</button>
      </section>

      <section class="expandable-section" id="skills-section" aria-label="Skills">
        <label id="label-skills">Skills</label>
        <div class="field-group" id="skills-group">
          <input type="text" name="skills[]" placeholder="Skill detail" />
        </div>
        <button type="button" id="add-skills" aria-controls="skills-group" aria-expanded="false" class="expand-btn">+ Add Skill</button>
      </section>

      <button type="submit" id="submit-btn">Submit Application</button>
    </form>
  </main>

  <!-- Popup security notice -->
  <div id="popup" role="alertdialog" aria-modal="true" aria-labelledby="popupTitle" style="display:none;">
    <p><strong>Security Notice:</strong> Due to high risks of malware in file uploads, we require you to copy-paste your resume information in plain text only.</p>
    <p>Please review these recent reports on cyber threats:</p>
    <ul>
      <li><a href="https://tech.co/news/data-breaches-updated-list" target="_blank" rel="noopener">Tech.co: Data Breaches Updated List</a></li>
      <li><a href="https://www.forbes.com/sites/daveywinder/2025/05/22/microsoft-attacks-windows-password-hackers-in-global-counter-strike" target="_blank" rel="noopener">Forbes: Microsoft Counterstrike</a></li>
      <li><a href="https://www.forbes.com/sites/thomasbrewster/2024/03/26/hackers-breach-hundreds-of-ai-compute-servers-researchers-say" target="_blank" rel="noopener">Forbes: AI Compute Servers Breach</a></li>
      <li><a href="https://www.forbes.com/sites/chuckbrooks/2025/05/18/growing-cyberthreats-to-the-internet-of-things" target="_blank" rel="noopener">Forbes: Cyberthreats IoT</a></li>
    </ul>
    <button id="popup-close-btn">I Understand, Continue</button>
  </div>

  <script nonce="abc123" type="module">
    // Language toggle
    const langSelect = document.getElementById('language-select');
    const textMap = {
      en: {
        title: 'Join Us at OPS Online Solutions',
        description: 'Please copy-paste your information into the fields below to apply securely.',
        labels: {
          firstName: 'First Name *',
          lastName: 'Last Name *',
          address: 'Address',
          zipCode: 'Zip Code',
          contactNumber: 'Contact Number *',
          email: 'Email *',
          experience: 'Experience',
          certification: 'Certification',
          education: 'Education',
          skills: 'Skills',
          submitBtn: 'Submit Application',
          addExp: '+ Add Experience',
          addCert: '+ Add Certification',
          addEdu: '+ Add Education',
          addSkill: '+ Add Skill'
        },
        popupText: {
          en: true,
          es: false
        }
      },
      es: {
        title: 'Únete a OPS Online Solutions',
        description: 'Por favor, copie y pegue su información en los campos a continuación para aplicar de forma segura.',
        labels: {
          firstName: 'Nombre *',
          lastName: 'Apellido *',
          address: 'Dirección',
          zipCode: 'Código Postal',
          contactNumber: 'Número de Contacto *',
          email: 'Correo Electrónico *',
          experience: 'Experiencia',
          certification: 'Certificación',
          education: 'Educación',
          skills: 'Habilidades',
          submitBtn: 'Enviar Aplicación',
          addExp: '+ Agregar Experiencia',
          addCert: '+ Agregar Certificación',
          addEdu: '+ Agregar Educación',
          addSkill: '+ Agregar Habilidad'
        },
        popupText: {
          en: false,
          es: true
        }
      }
    };

    function setLanguage(lang) {
      const t = textMap[lang];
      document.getElementById('pageTitle').textContent = t.title;
      document.getElementById('description').textContent = t.description;
      document.getElementById('label-firstName').textContent = t.labels.firstName;
      document.getElementById('label-lastName').textContent = t.labels.lastName;
      document.getElementById('label-address').textContent = t.labels.address;
      document.getElementById('label-zipCode').textContent = t.labels.zipCode;
      document.getElementById('label-contactNumber').textContent = t.labels.contactNumber;
      document.getElementById('label-email').textContent = t.labels.email;
      document.getElementById('label-experience').textContent = t.labels.experience;
      document.getElementById('label-certification').textContent = t.labels.certification;
      document.getElementById('label-education').textContent = t.labels.education;
      document.getElementById('label-skills').textContent = t.labels.skills;
      document.getElementById('submit-btn').textContent = t.labels.submitBtn;
      document.getElementById('add-experience').textContent = t.labels.addExp;
      document.getElementById('add-certification').textContent = t.labels.addCert;
      document.getElementById('add-education').textContent = t.labels.addEdu;
      document.getElementById('add-skills').textContent = t.labels.addSkill;
      document.getElementById('popup-text-en').style.display = t.popupText.en ? 'block' : 'none';
      document.getElementById('popup-text-es').style.display = t.popupText.es ? 'block' : 'none';
    }

    langSelect.addEventListener('change', (e) => {
      setLanguage(e.target.value);
    });

    setLanguage('en'); // default language

    // Popup logic
    const popup = document.getElementById('popup');
    const popupCloseBtn = document.getElementById('popup-close-btn');
    popup.style.display = 'block';
    popupCloseBtn.addEventListener('click', () => {
      popup.style.display = 'none';
    });

    // Expandable fields logic
    function setupExpandable(sectionId) {
      const addBtn = document.getElementById(`add-${sectionId}`);
      const group = document.getElementById(`${sectionId}-group`);
      addBtn.addEventListener('click', () => {
        const input = document.createElement('input');
        input.type = 'text';
        input.name = `${sectionId}[]`;
        input.placeholder = langSelect.value === 'en'
          ? `${sectionId.charAt(0).toUpperCase() + sectionId.slice(1)} detail`
          : `Detalle de ${sectionId}`;
        input.style.marginTop = '0.3rem';
        group.appendChild(input);
      });
    }
    setupExpandable('experience');
    setupExpandable('certification');
    setupExpandable('education');
    setupExpandable('skills');

    // Web Crypto helpers
    function generateUUID() {
      return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
        (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
      );
    }

    function generateNonce(length = 16) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let result = '';
      for(let i = 0; i < length; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return result;
    }

    async function importKey(secret) {
      const enc = new TextEncoder();
      return crypto.subtle.importKey(
        "raw",
        enc.encode(secret),
        { name: "HMAC", hash: "SHA-256" },
        false,
        ["sign"]
      );
    }

    async function computeHmac(key, message) {
      const signature = await crypto.subtle.sign(
        "HMAC",
        key,
        new TextEncoder().encode(message)
      );
      return [...new Uint8Array(signature)].map(b => b.toString(16).padStart(2, '0')).join('');
    }

    async function encryptData(key, plaintext) {
      const iv = crypto.getRandomValues(new Uint8Array(12)); // 96-bit IV
      const enc = new TextEncoder();
      const encrypted = await crypto.subtle.encrypt(
        {
          name: "AES-GCM",
          iv: iv
        },
        key,
        enc.encode(plaintext)
      );
      const ivStr = btoa(String.fromCharCode(...iv));
      const encryptedStr = btoa(String.fromCharCode(...new Uint8Array(encrypted)));
      return ivStr + ":" + encryptedStr;
    }

    async function importAesKey(secret) {
      const enc = new TextEncoder();
      return crypto.subtle.importKey(
        "raw",
        enc.encode(secret),
        "AES-GCM",
        false,
        ["encrypt", "decrypt"]
      );
    }

    // Form submit handler
    document.getElementById('join-form').addEventListener('submit', async function(event) {
      event.preventDefault();

      const form = event.target;
      const metadata = {
        assetId: generateUUID(),
        firstName: form.firstName.value.trim(),
        lastName: form.lastName.value.trim(),
        address: form.address.value.trim(),
        zipCode: form.zipCode.value.trim(),
        contactNumber: form.contactNumber.value.trim(),
        email: form.email.value.trim(),
        experience: Array.from(form.querySelectorAll('input[name="experience[]"]'))
                         .map(i => i.value.trim())
                         .filter(v => v),
        certification: Array.from(form.querySelectorAll('input[name="certification[]"]'))
                            .map(i => i.value.trim())
                            .filter(v => v),
        education: Array.from(form.querySelectorAll('input[name="education[]"]'))
                        .map(i => i.value.trim())
                        .filter(v => v),
        skills: Array.from(form.querySelectorAll('input[name="skills[]"]'))
                     .map(i => i.value.trim())
                     .filter(v => v)
      };

      // Validation
      if (!metadata.firstName || !metadata.lastName || !metadata.contactNumber || !metadata.email) {
        alert(langSelect.value === 'en'
          ? 'Please fill in all required fields (*)'
          : 'Por favor complete todos los campos obligatorios (*)');
        return;
      }

      const SECRET_KEY = "YOUR_SECRET_KEY"; // NEVER expose on client in production! This is demo only.
      const AUTH_TOKEN = "YOUR_AUTH_TOKEN";

      try {
        const hmacKey = await importKey(SECRET_KEY);
        const aesKey = await importAesKey(SECRET_KEY);
        const nonce = generateNonce();
        const timestamp = new Date().toISOString();

        const message = JSON.stringify(metadata) + nonce + timestamp;
        const signature = await computeHmac(hmacKey, message);
        const encryptedMetadata = await encryptData(aesKey, JSON.stringify(metadata));

        const payload = {
          encryptedMetadata,
          nonce,
          timestamp,
          signature,
          authToken: AUTH_TOKEN
        };

        const response = await fetch('https://YOUR_CLOUDFLARE_WORKER_ENDPOINT', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        const result = await response.json();
        if (result.status === 'success') {
          alert(langSelect.value === 'en'
            ? 'Your application has been submitted securely. Thank you!'
            : 'Su solicitud ha sido enviada de forma segura. ¡Gracias!');
          form.reset();
        } else {
          alert((langSelect.value === 'en'
            ? 'Error submitting your application: '
            : 'Error al enviar su solicitud: ') + result.message);
        }
      } catch (err) {
        console.error(err);
        alert(langSelect.value === 'en'
          ? 'An unexpected error occurred during submission.'
          : 'Ocurrió un error inesperado durante el envío.');
      }
    });
  </script>
</body>
</html>
